@model IEnumerable<Travel_Booking.Models.TravelDestinationModel>

@{
    ViewData["Title"] = "Destinations";
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">

<div class="container-fluid mt-4">
    <div class="row">
        <aside class="col-md-3 mb-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Filters</h5>
                    <hr />
                    <div class="mb-3">
                        <label for="searchInput" class="form-label">Search</label>
                        <input type="text" id="searchInput" class="form-control" placeholder="Search destinations...">
                    </div>

                    <div class="mb-3">
                        <h6>Price Range</h6>
                        <input type="text" id="priceRange" readonly class="form-control mb-2">
                        <div id="priceSlider"></div>
                    </div>

                    <button class="btn btn-primary w-100 mb-2" id="applyFiltersBtn">Apply Filters</button>
                    <button class="btn btn-outline-secondary w-100" id="clearFiltersBtn">Clear All</button>
                </div>
            </div>
        </aside>

        <main class="col-md-9" id="destinationList">
            @Html.Partial("_DestinationListPartial", Model)
        </main>
    </div>
</div>

<style>
    .hover-shadow:hover {
        transform: scale(1.02);
        transition: transform 0.2s;
        box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.15) !important;
    }
</style>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
<script>
    $(function () {
        var minPrice = 0;
        var maxPrice = 5000;

        function applyFilters() {
            var priceValues = $("#priceSlider").slider("values");
            var searchText = $("#searchInput").val();

            $.ajax({
                url: '@Url.Action("Filter", "Travel")',
                type: 'GET',
                data: {
                    minPrice: priceValues[0],
                    maxPrice: priceValues[1],
                    searchText: searchText
                },
                success: function (result) {
                    $("#destinationList").html(result);
                }
            });
        }

        $("#priceSlider").slider({
            range: true,
            min: minPrice,
            max: maxPrice,
            values: [minPrice, maxPrice],
            slide: function (event, ui) {
                $("#priceRange").val("RM" + ui.values[0] + " - RM" + ui.values[1]);
                applyFilters();
            }
        });

        $("#priceRange").val("RM" + minPrice + " - RM" + maxPrice);

        $("#searchInput").on('input', applyFilters);

        $("#clearFiltersBtn").click(function () {
            $("#searchInput").val('');
            $("#priceSlider").slider("values", [minPrice, maxPrice]);
            $("#priceRange").val("RM" + minPrice + " - RM" + maxPrice);
            applyFilters();
        });
    });
</script>

